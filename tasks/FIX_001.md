# FIX_001: Critical Type Mismatches - SmartGoal vs SmartGoalCreate

**Priority**: CRITICAL
**Estimated Time**: 2-3 hours
**Files Affected**: 7 errors across 4 files

## Overview

There's a fundamental type incompatibility between `SmartGoal` and `SmartGoalCreate` types causing cascading errors throughout the GoalWizard system.

## Errors to Fix

### 1. Goal Creation Handler Type Mismatch
**File**: `src/app/goals/new/page.tsx:128`
```typescript
// ERROR: Type '(goal: SmartGoal) => Promise<void>' is not assignable to type '(goal: SmartGoalCreate) => void'
onSave={handleSave}
```

### 2. SmartScoreBadge Type Mismatch
**File**: `src/components/GoalWizard/GoalWizard.tsx:435`
```typescript
// ERROR: SmartScoreBadge expects SmartGoal but receives SmartGoalCreate
goal={exportFunctions.generatePreview()}
```

### 3. Missing Properties in GoalWizard Utils
**File**: `src/components/GoalWizard/GoalWizard.utils.ts:492`
```typescript
// ERROR: 'checkpoints' does not exist in type 'SmartGoalCreate'
checkpoints: [],
```

### 4. SMART Score Calculation Type Error
**File**: `src/components/GoalWizard/WizardContext.tsx:226`
```typescript
// ERROR: calculateSmartScore expects SmartGoal but receives SmartGoalCreate
const scoreResult = calculateSmartScore(smartGoal);
```

## Solution Strategy

### Option A: Extend SmartGoalCreate (Recommended)
Add missing properties to `SmartGoalCreate` with default values:

```typescript
// In types file
export interface SmartGoalCreate extends Omit<SmartGoal, 'id' | 'createdAt' | 'updatedAt'> {
  // Add missing properties with defaults
  checkpoints?: Checkpoint[];
  childGoalIds?: string[];
  tasks?: Task[];
  milestones?: Milestone[];
  // ... other missing properties
}
```

### Option B: Create Transformation Functions
Create utility functions to convert between types:

```typescript
export function createGoalFromWizard(goalCreate: SmartGoalCreate): SmartGoal {
  return {
    ...goalCreate,
    id: generateId(),
    checkpoints: [],
    childGoalIds: [],
    tasks: [],
    milestones: [],
    createdAt: new Date().toISOString(),
    updatedAt: new Date().toISOString(),
    // ... other required properties
  };
}
```

## Implementation Steps

1. **Analyze missing properties** between SmartGoal and SmartGoalCreate
2. **Update SmartGoalCreate interface** to include missing properties as optional
3. **Update GoalWizard.utils.ts** to handle new optional properties
4. **Fix handleSave function** in goal creation page to properly handle types
5. **Update SmartScoreBadge** to accept both types or create adapter
6. **Test all goal creation workflows** to ensure no regressions

## Files to Modify

- [ ] `src/types/SmartGoal.types.ts` - Update SmartGoalCreate interface
- [ ] `src/app/goals/new/page.tsx` - Fix handleSave function
- [ ] `src/components/GoalWizard/GoalWizard.tsx` - Fix preview generation
- [ ] `src/components/GoalWizard/GoalWizard.utils.ts` - Add missing properties
- [ ] `src/components/GoalWizard/WizardContext.tsx` - Fix score calculation
- [ ] `src/components/SmartScoreBadge/SmartScoreBadge.tsx` - Support both types

## Testing

- [ ] Goal creation wizard completes successfully
- [ ] SMART score calculation works in preview
- [ ] Goal save process works end-to-end
- [ ] No type errors in affected components
- [ ] Existing tests still pass

## Dependencies

This fix blocks many other TypeScript errors in the GoalWizard system. Complete this before moving to FIX_002.